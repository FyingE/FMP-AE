# FMP-TAE: Feature Map Matrix Profile Combined with a Transformer-based Autoencoder for Time Series Anomaly Detection

## Overview

With the increasing digitization of society and industrial processes, an immense amount of time series data is being generated by sensor-equipped devices, such as data from financial markets, meteorological measurements, web traffic monitoring, and industrial manufacturing sensors. Time Series Anomaly Detection (TSAD) is crucial in identifying data points that deviate significantly from normal patterns. This technology is used in various fields such as finance (fraud detection), healthcare (early detection of health issues), manufacturing (preventing equipment breakdowns), and cybersecurity (identifying abnormal network traffic). However, TSAD faces significant challenges such as label scarcity, the need for generalizability across different domains, and computational efficiency for large-scale deployment.

This repository implements a novel approach to TSAD, called **FMP-TAE** (Feature Map Matrix Profile combined with a Transformer-based Autoencoder). Our model addresses the challenges of label scarcity, generalizability, and efficiency by utilizing CNNs for feature extraction, a Matrix Profile-based loss function, and a Transformer-based Autoencoder for effective anomaly detection.

## Key Contributions

1. **Novel Loss Function**: We introduce a novel loss function that integrates inter-window and intra-window Matrix Profile (MP) losses, combined with the reconstruction loss of the Autoencoder. This combined loss enhances the model‚Äôs ability to detect sparse anomalies and capture both global and local anomaly patterns.

2. **Multi-channel CNN for Feature Extraction**: We employ a multi-channel Convolutional Neural Network (CNN) to extract features and compute the Matrix Profile, improving the model‚Äôs computational efficiency and ensuring high accuracy across diverse time series domains.

3. **Transformer-based Autoencoder**: Our model incorporates a Transformer-based Autoencoder that captures both long-range and local temporal dependencies, significantly improving the model's ability to generalize across various time series data.

4. **Extensive Evaluation**: We perform extensive experiments on five benchmark datasets, demonstrating superior performance in multiple evaluation metrics (Precision, Recall, F1-score, AUC-PR, AUC-ROC), validated through ablation studies to prove the effectiveness of each component.


## üîë Key Features

- **Dual Loss Function**: Incorporates reconstruction loss, external matrix profile loss, and internal matrix profile loss for comprehensive training.
- **State-of-the-Art Architecture**: Utilizes CNNs for feature extraction and attention-based autoencoders for reconstruction, providing an optimal combination for time series anomaly detection.
- **Flexible Model**: Designed to be adaptable to various time series datasets and capable of identifying both subtle and more obvious anomalies.
- **Point Adjustment for Anomaly Sequences**: Enhances performance by adjusting detected anomalies over time to reduce false positives.

## üèóÔ∏è Model Architecture

The architecture of FMP-TAE consists of three main components:

1. **CNN Encoder**: Extracts local temporal features from the time series data, learning hierarchical representations.
2. **Attention-Based Autoencoder**: Reconstructs the input data using an attention mechanism, capturing long-range dependencies.
3. **Loss Functions**:
    - **Reconstruction Loss**: Measures how accurately the model can reconstruct the original input.
    - **External Matrix Profile Loss**: Encourages similarity between windowed segments of the time series at different positions.
    - **Internal Matrix Profile Loss**: Ensures consistency within each window, preventing overfitting to local noise.



## Key Parameters

- `lambda_1`, `lambda_2`, `lambda_3`: Hyperparameters that control the relative importance of the inter-window Matrix Profile, intra-window Matrix Profile, and reconstruction loss during training.
- `tau`: Threshold for anomaly classification. Anomalies are classified based on whether the anomaly score exceeds this threshold.
- `step_size`: Step size for the sliding window used in time series segmentation.

## Results

In our experiments on multiple benchmark datasets, **FMP-TAE** demonstrated:

- **Superior performance** in terms of precision, recall, F1-score, AUC-PR, and AUC-ROC.
- **Robustness** across diverse time series domains, including finance, healthcare, and industrial monitoring.
- **Scalability and efficiency**, making it suitable for real-time anomaly detection tasks.


## Installation

To use the **FMP-AE** model, you need to have the following dependencies:

- Python 3.x
- PyTorch (1.x or higher)
- NumPy
- SciPy
- Matplotlib (optional, for visualization)

