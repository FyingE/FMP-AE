# FMP-TAE: Feature Map Matrix Profile Combined with a Transformer-based Autoencoder for Time Series Anomaly Detection

## Overview

With the increasing digitization of society and industrial processes, an immense amount of time series data is being generated by sensor-equipped devices, such as data from financial markets, meteorological measurements, web traffic monitoring, and industrial manufacturing sensors. Time Series Anomaly Detection (TSAD) is crucial in identifying data points that deviate significantly from normal patterns. This technology is used in various fields such as finance (fraud detection), healthcare (early detection of health issues), manufacturing (preventing equipment breakdowns), and cybersecurity (identifying abnormal network traffic). However, TSAD faces significant challenges such as label scarcity, the need for generalizability across different domains, and computational efficiency for large-scale deployment.

This repository implements a novel approach to TSAD, called **FMP-TAE** (Feature Map Matrix Profile combined with a Transformer-based Autoencoder). Our model addresses the challenges of label scarcity, generalizability, and efficiency by utilizing CNNs for feature extraction, a Matrix Profile-based loss function, and a Transformer-based Autoencoder for effective anomaly detection.

## Key Contributions

1. **Novel Loss Function**: We introduce a novel loss function that integrates inter-window and intra-window Matrix Profile (MP) losses, combined with the reconstruction loss of the Autoencoder. This combined loss enhances the model’s ability to detect sparse anomalies and capture both global and local anomaly patterns.

2. **Multi-channel CNN for Feature Extraction**: We employ a multi-channel Convolutional Neural Network (CNN) to extract features and compute the Matrix Profile, improving the model’s computational efficiency and ensuring high accuracy across diverse time series domains.

3. **Transformer-based Autoencoder**: Our model incorporates a Transformer-based Autoencoder that captures both long-range and local temporal dependencies, significantly improving the model's ability to generalize across various time series data.

4. **Extensive Evaluation**: We perform extensive experiments on five benchmark datasets, demonstrating superior performance in multiple evaluation metrics (Precision, Recall, F1-score, AUC-PR, AUC-ROC), validated through ablation studies to prove the effectiveness of each component.


## Key Features

- **Hybrid Model**: Combines Matrix Profile techniques with deep learning (1D-CNN and Autoencoder) for enhanced anomaly detection.
- **Sliding Window Technique**: Improves sensitivity to sparse anomalies by processing smaller subsequences.
- **Matrix Profile Loss**: A novel loss function that integrates Matrix Profile loss with the Autoencoder's reconstruction loss, improving anomaly detection accuracy.
- **Efficient and Scalable**: Optimized for large-scale time series data, improving both computational efficiency and model generalization across domains.

## Model Architecture

The **FMP-TAE** architecture consists of three main components:

1. **Multi-channel CNN for Feature Extraction**: This component extracts the temporal features from the time series data. The CNN is designed to accelerate the computation of the Matrix Profile (MP) by enabling parallel processing, which greatly improves computational efficiency.

2. **Loss Function Module**: The model employs a sliding window technique to compute both inter-window and intra-window MP losses. These losses are then combined with the Autoencoder's reconstruction loss to guide anomaly detection in an unsupervised manner.

3. **Transformer-based Autoencoder**: The Autoencoder architecture is based on a Transformer model, which helps capture long-range dependencies and fine-grained local patterns in the time series data, improving the ability to detect both local and global anomalies.


## Key Parameters

- `lambda_1`, `lambda_2`, `lambda_3`: Hyperparameters that control the relative importance of the inter-window Matrix Profile, intra-window Matrix Profile, and reconstruction loss during training.
- `tau`: Threshold for anomaly classification. Anomalies are classified based on whether the anomaly score exceeds this threshold.
- `step_size`: Step size for the sliding window used in time series segmentation.

## Results

In our experiments on multiple benchmark datasets, **FMP-TAE** demonstrated:

- **Superior performance** in terms of precision, recall, F1-score, AUC-PR, and AUC-ROC.
- **Robustness** across diverse time series domains, including finance, healthcare, and industrial monitoring.
- **Scalability and efficiency**, making it suitable for real-time anomaly detection tasks.


## Installation

To use the **FMP-AE** model, you need to have the following dependencies:

- Python 3.x
- PyTorch (1.x or higher)
- NumPy
- SciPy
- Matplotlib (optional, for visualization)

